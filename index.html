<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slime Soccer с настройками</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(to bottom, #1a2a6c, #b21f1f, #fdbb2d);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            color: white;
        }
        
        #game-container {
            position: relative;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            overflow: hidden;
        }
        
        canvas {
            background: #2e8b57;
            display: block;
        }
        
        #score {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 36px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
            font-weight: bold;
        }
        
        #player-names {
            position: absolute;
            top: 70px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            padding: 0 30px;
            font-size: 20px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
        }
        
        #instructions {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            text-align: center;
            color: white;
            font-size: 18px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
        }
        
        #game-over {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 48px;
            display: none;
            z-index: 10;
        }
        
        #restart {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 24px;
            background: #4CAF50;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        #restart:hover {
            background: #45a049;
        }
        
        #bonus-indicator {
            position: absolute;
            top: 100px;
            left: 0;
            right: 0;
            text-align: center;
            color: gold;
            font-size: 20px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
            display: none;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        /* Стили для меню настроек */
        #settings-menu {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
            padding: 20px;
        }
        
        .settings-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        .settings-title {
            font-size: 36px;
            text-align: center;
            margin-bottom: 30px;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
        }
        
        .settings-section {
            margin-bottom: 25px;
        }
        
        .settings-section h3 {
            font-size: 22px;
            margin-bottom: 15px;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
        }
        
        .player-settings {
            display: flex;
            justify-content: space-between;
            gap: 20px;
        }
        
        .player-setting {
            flex: 1;
        }
        
        .player-setting label {
            display: block;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .player-setting input {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: none;
            margin-bottom: 10px;
        }
        
        .color-picker {
            display: flex;
            gap: 5px;
            margin-top: 5px;
        }
        
        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: transform 0.2s;
        }
        
        .color-option:hover {
            transform: scale(1.1);
        }
        
        .color-option.selected {
            border-color: white;
            transform: scale(1.1);
        }
        
        .speed-options {
            display: flex;
            gap: 10px;
        }
        
        .speed-option {
            flex: 1;
            padding: 10px;
            text-align: center;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .speed-option:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .speed-option.selected {
            background: #4CAF50;
        }
        
        #start-game {
            display: block;
            width: 100%;
            padding: 15px;
            font-size: 20px;
            background: #4CAF50;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
            margin-top: 20px;
        }
        
        #start-game:hover {
            background: #45a049;
        }
        
        #settings-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 5px;
            color: white;
            padding: 8px 15px;
            cursor: pointer;
            font-size: 16px;
            z-index: 5;
        }
        
        #settings-button:hover {
            background: rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
    <div id="game-container">
        <canvas id="gameCanvas" width="800" height="500"></canvas>
        <div id="score">0 : 0</div>
        <div id="player-names">
            <span id="blue-player-name">Синий</span>
            <span id="red-player-name">Красный</span>
        </div>
        <div id="bonus-indicator">ЗОЛОТОЙ МЯЧ! +2 ОЧКА!</div>
        <div id="instructions">
            Синий: W - прыжок, A/D - движение | Красный: Стрелка вверх - прыжок, Стрелки влево/вправо - движение
        </div>
        <button id="settings-button">Настройки</button>
        <div id="game-over">
            <div id="winner-text">Победа!</div>
            <button id="restart">Играть снова</button>
        </div>
        
        <!-- Меню настроек -->
        <div id="settings-menu">
            <div class="settings-container">
                <h2 class="settings-title">Slime Soccer - Настройки</h2>
                
                <div class="settings-section">
                    <h3>Скорость игры</h3>
                    <div class="speed-options">
                        <div class="speed-option selected" data-speed="slow">Медленная</div>
                        <div class="speed-option" data-speed="normal">Нормальная</div>
                        <div class="speed-option" data-speed="fast">Быстрая</div>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>Настройки игроков</h3>
                    <div class="player-settings">
                        <div class="player-setting">
                            <label for="blue-player-name">Имя синего игрока:</label>
                            <input type="text" id="blue-name-input" value="Синий" maxlength="10">
                            <label>Цвет слайма:</label>
                            <div class="color-picker" id="blue-color-picker">
                                <div class="color-option selected" style="background-color: #3498db;" data-color="#3498db"></div>
                                <div class="color-option" style="background-color: #2980b9;" data-color="#2980b9"></div>
                                <div class="color-option" style="background-color: #1abc9c;" data-color="#1abc9c"></div>
                                <div class="color-option" style="background-color: #9b59b6;" data-color="#9b59b6"></div>
                            </div>
                        </div>
                        
                        <div class="player-setting">
                            <label for="red-player-name">Имя красного игрока:</label>
                            <input type="text" id="red-name-input" value="Красный" maxlength="10">
                            <label>Цвет слайма:</label>
                            <div class="color-picker" id="red-color-picker">
                                <div class="color-option selected" style="background-color: #e74c3c;" data-color="#e74c3c"></div>
                                <div class="color-option" style="background-color: #c0392b;" data-color="#c0392b"></div>
                                <div class="color-option" style="background-color: #e67e22;" data-color="#e67e22"></div>
                                <div class="color-option" style="background-color: #d35400;" data-color="#d35400"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button id="start-game">Начать игру</button>
            </div>
        </div>
    </div>

    <script>
        // Получаем элементы
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const bluePlayerNameElement = document.getElementById('blue-player-name');
        const redPlayerNameElement = document.getElementById('red-player-name');
        const bonusIndicator = document.getElementById('bonus-indicator');
        const gameOverElement = document.getElementById('game-over');
        const winnerTextElement = document.getElementById('winner-text');
        const restartButton = document.getElementById('restart');
        const settingsButton = document.getElementById('settings-button');
        const settingsMenu = document.getElementById('settings-menu');
        const startGameButton = document.getElementById('start-game');
        const blueNameInput = document.getElementById('blue-name-input');
        const redNameInput = document.getElementById('red-name-input');
        const blueColorPicker = document.getElementById('blue-color-picker');
        const redColorPicker = document.getElementById('red-color-picker');
        const speedOptions = document.querySelectorAll('.speed-option');
        
        // Константы игры
        const GRAVITY = 0.5;
        const FRICTION = 0.99;
        const BOUNCE = 0.7;
        const SLIME_JUMP = -12;
        const SLIME_SPEED = 5;
        const BALL_RADIUS = 15;
        const GOAL_WIDTH = 150;
        const GOAL_HEIGHT = 100;
        
        // Настройки скорости
        const speedSettings = {
            slow: { gravity: 0.3, slimeSpeed: 3, slimeJump: -10, ballSpeedMultiplier: 0.7 },
            normal: { gravity: 0.5, slimeSpeed: 5, slimeJump: -12, ballSpeedMultiplier: 1.0 },
            fast: { gravity: 0.8, slimeSpeed: 7, slimeJump: -14, ballSpeedMultiplier: 1.3 }
        };
        
        let currentSpeed = 'normal';
        
        // Игровые объекты
        const slimes = {
            blue: {
                x: 100,
                y: canvas.height - 60,
                width: 80,
                height: 60,
                color: '#3498db',
                velocityX: 0,
                velocityY: 0,
                isJumping: false,
                score: 0,
                name: 'Синий'
            },
            red: {
                x: canvas.width - 180,
                y: canvas.height - 60,
                width: 80,
                height: 60,
                color: '#e74c3c',
                velocityX: 0,
                velocityY: 0,
                isJumping: false,
                score: 0,
                name: 'Красный'
            }
        };
        
        const ball = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            radius: BALL_RADIUS,
            velocityX: 0,
            velocityY: 0,
            color: '#fff'
        };
        
        // Золотой мяч-бонус
        const goldenBall = {
            x: 0,
            y: 0,
            radius: BALL_RADIUS,
            velocityX: 0,
            velocityY: 0,
            color: 'gold',
            active: false,
            used: false
        };
        
        // Состояние игры
        const keys = {};
        let gameRunning = false;
        let bonusActive = false;
        let bonusTimer = 0;
        const BONUS_DURATION = 300; // 5 секунд при 60 FPS
        
        // Обработчики событий
        window.addEventListener('keydown', (e) => {
            keys[e.key] = true;
        });
        
        window.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });
        
        restartButton.addEventListener('click', resetGame);
        settingsButton.addEventListener('click', showSettings);
        startGameButton.addEventListener('click', startGame);
        
        // Настройка выбора цвета
        function setupColorPickers() {
            // Синий игрок
            const blueColorOptions = blueColorPicker.querySelectorAll('.color-option');
            blueColorOptions.forEach(option => {
                option.addEventListener('click', () => {
                    blueColorOptions.forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    slimes.blue.color = option.getAttribute('data-color');
                });
            });
            
            // Красный игрок
            const redColorOptions = redColorPicker.querySelectorAll('.color-option');
            redColorOptions.forEach(option => {
                option.addEventListener('click', () => {
                    redColorOptions.forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    slimes.red.color = option.getAttribute('data-color');
                });
            });
        }
        
        // Настройка выбора скорости
        function setupSpeedOptions() {
            speedOptions.forEach(option => {
                option.addEventListener('click', () => {
                    speedOptions.forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    currentSpeed = option.getAttribute('data-speed');
                });
            });
        }
        
        // Показать настройки
        function showSettings() {
            settingsMenu.style.display = 'flex';
            gameRunning = false;
        }
        
        // Начать игру
        function startGame() {
            // Обновляем имена игроков
            slimes.blue.name = blueNameInput.value || 'Синий';
            slimes.red.name = redNameInput.value || 'Красный';
            
            bluePlayerNameElement.textContent = slimes.blue.name;
            redPlayerNameElement.textContent = slimes.red.name;
            
            // Скрываем меню настроек
            settingsMenu.style.display = 'none';
            
            // Сбрасываем игру
            resetGame();
            
            // Запускаем игру
            gameRunning = true;
        }
        
        // Функция сброса игры
        function resetGame() {
            slimes.blue.x = 100;
            slimes.blue.y = canvas.height - 60;
            slimes.blue.velocityX = 0;
            slimes.blue.velocityY = 0;
            slimes.blue.isJumping = false;
            slimes.blue.score = 0;
            
            slimes.red.x = canvas.width - 180;
            slimes.red.y = canvas.height - 60;
            slimes.red.velocityX = 0;
            slimes.red.velocityY = 0;
            slimes.red.isJumping = false;
            slimes.red.score = 0;
            
            ball.x = canvas.width / 2;
            ball.y = canvas.height / 2;
            ball.velocityX = 0;
            ball.velocityY = 0;
            
            goldenBall.active = false;
            goldenBall.used = false;
            bonusActive = false;
            bonusTimer = 0;
            bonusIndicator.style.display = 'none';
            
            gameRunning = true;
            gameOverElement.style.display = 'none';
            updateScore();
        }
        
        // Функция активации золотого мяча
        function activateGoldenBall() {
            if (goldenBall.used) return; // Бонус можно использовать только один раз за игру
            
            goldenBall.active = true;
            goldenBall.used = true;
            bonusActive = true;
            bonusTimer = BONUS_DURATION;
            bonusIndicator.style.display = 'block';
            
            // Размещаем золотой мяч в случайном месте на поле
            goldenBall.x = Math.random() * (canvas.width - 100) + 50;
            goldenBall.y = Math.random() * (canvas.height - 200) + 50;
            goldenBall.velocityX = 0;
            goldenBall.velocityY = 0;
        }
        
        // Функция обновления игры
        function update() {
            if (!gameRunning) return;
            
            // Получаем текущие настройки скорости
            const speed = speedSettings[currentSpeed];
            
            // Обновление синего слайма
            if (keys['a'] || keys['A']) {
                slimes.blue.velocityX = -speed.slimeSpeed;
            } else if (keys['d'] || keys['D']) {
                slimes.blue.velocityX = speed.slimeSpeed;
            } else {
                slimes.blue.velocityX = 0;
            }
            
            if ((keys['w'] || keys['W']) && !slimes.blue.isJumping) {
                slimes.blue.velocityY = speed.slimeJump;
                slimes.blue.isJumping = true;
            }
            
            // Обновление красного слайма
            if (keys['ArrowLeft']) {
                slimes.red.velocityX = -speed.slimeSpeed;
            } else if (keys['ArrowRight']) {
                slimes.red.velocityX = speed.slimeSpeed;
            } else {
                slimes.red.velocityX = 0;
            }
            
            if (keys['ArrowUp'] && !slimes.red.isJumping) {
                slimes.red.velocityY = speed.slimeJump;
                slimes.red.isJumping = true;
            }
            
            // Применение гравитации и движения
            slimes.blue.y += slimes.blue.velocityY;
            slimes.blue.velocityY += speed.gravity;
            
            slimes.red.y += slimes.red.velocityY;
            slimes.red.velocityY += speed.gravity;
            
            slimes.blue.x += slimes.blue.velocityX;
            slimes.red.x += slimes.red.velocityX;
            
            // Ограничение движения слаймов по горизонтали
            if (slimes.blue.x < 0) slimes.blue.x = 0;
            if (slimes.blue.x > canvas.width / 2 - slimes.blue.width) slimes.blue.x = canvas.width / 2 - slimes.blue.width;
            
            if (slimes.red.x < canvas.width / 2) slimes.red.x = canvas.width / 2;
            if (slimes.red.x > canvas.width - slimes.red.width) slimes.red.x = canvas.width - slimes.red.width;
            
            // Проверка приземления слаймов
            if (slimes.blue.y > canvas.height - slimes.blue.height) {
                slimes.blue.y = canvas.height - slimes.blue.height;
                slimes.blue.velocityY = 0;
                slimes.blue.isJumping = false;
            }
            
            if (slimes.red.y > canvas.height - slimes.red.height) {
                slimes.red.y = canvas.height - slimes.red.height;
                slimes.red.velocityY = 0;
                slimes.red.isJumping = false;
            }
            
            // Обновление мяча
            ball.x += ball.velocityX * speed.ballSpeedMultiplier;
            ball.y += ball.velocityY * speed.ballSpeedMultiplier;
            ball.velocityY += speed.gravity;
            
            // Применение трения
            ball.velocityX *= FRICTION;
            ball.velocityY *= FRICTION;
            
            // Обновление золотого мяча, если он активен
            if (goldenBall.active) {
                goldenBall.x += goldenBall.velocityX * speed.ballSpeedMultiplier;
                goldenBall.y += goldenBall.velocityY * speed.ballSpeedMultiplier;
                goldenBall.velocityY += speed.gravity;
                
                // Применение трения
                goldenBall.velocityX *= FRICTION;
                goldenBall.velocityY *= FRICTION;
                
                // Обновление таймера бонуса
                bonusTimer--;
                if (bonusTimer <= 0) {
                    goldenBall.active = false;
                    bonusActive = false;
                    bonusIndicator.style.display = 'none';
                }
            }
            
            // Столкновение мяча со стенами
            if (ball.x - ball.radius < 0) {
                ball.x = ball.radius;
                ball.velocityX = -ball.velocityX * BOUNCE;
            }
            
            if (ball.x + ball.radius > canvas.width) {
                ball.x = canvas.width - ball.radius;
                ball.velocityX = -ball.velocityX * BOUNCE;
            }
            
            if (ball.y - ball.radius < 0) {
                ball.y = ball.radius;
                ball.velocityY = -ball.velocityY * BOUNCE;
            }
            
            if (ball.y + ball.radius > canvas.height) {
                ball.y = canvas.height - ball.radius;
                ball.velocityY = -ball.velocityY * BOUNCE;
            }
            
            // Столкновение золотого мяча со стенами
            if (goldenBall.active) {
                if (goldenBall.x - goldenBall.radius < 0) {
                    goldenBall.x = goldenBall.radius;
                    goldenBall.velocityX = -goldenBall.velocityX * BOUNCE;
                }
                
                if (goldenBall.x + goldenBall.radius > canvas.width) {
                    goldenBall.x = canvas.width - goldenBall.radius;
                    goldenBall.velocityX = -goldenBall.velocityX * BOUNCE;
                }
                
                if (goldenBall.y - goldenBall.radius < 0) {
                    goldenBall.y = goldenBall.radius;
                    goldenBall.velocityY = -goldenBall.velocityY * BOUNCE;
                }
                
                if (goldenBall.y + goldenBall.radius > canvas.height) {
                    goldenBall.y = canvas.height - goldenBall.radius;
                    goldenBall.velocityY = -goldenBall.velocityY * BOUNCE;
                }
            }
            
            // Проверка забития гола
            if (ball.x < 0) {
                if (bonusActive) {
                    slimes.red.score += 2;
                } else {
                    slimes.red.score++;
                }
                updateScore();
                resetBall();
                
                // Случайная активация золотого мяча после гола (30% шанс)
                if (!goldenBall.used && Math.random() < 0.3) {
                    activateGoldenBall();
                }
            }
            
            if (ball.x > canvas.width) {
                if (bonusActive) {
                    slimes.blue.score += 2;
                } else {
                    slimes.blue.score++;
                }
                updateScore();
                resetBall();
                
                // Случайная активация золотого мяча после гола (30% шанс)
                if (!goldenBall.used && Math.random() < 0.3) {
                    activateGoldenBall();
                }
            }
            
            // Проверка забития гола золотым мячом
            if (goldenBall.active) {
                if (goldenBall.x < 0) {
                    slimes.red.score += 2;
                    updateScore();
                    goldenBall.active = false;
                    bonusActive = false;
                    bonusIndicator.style.display = 'none';
                    resetBall();
                }
                
                if (goldenBall.x > canvas.width) {
                    slimes.blue.score += 2;
                    updateScore();
                    goldenBall.active = false;
                    bonusActive = false;
                    bonusIndicator.style.display = 'none';
                    resetBall();
                }
            }
            
            // Проверка столкновения мяча со слаймами
            checkSlimeCollision(slimes.blue, ball);
            checkSlimeCollision(slimes.red, ball);
            
            // Проверка столкновения золотого мяча со слаймами
            if (goldenBall.active) {
                checkSlimeCollision(slimes.blue, goldenBall);
                checkSlimeCollision(slimes.red, goldenBall);
            }
            
            // Проверка победы
            if (slimes.blue.score >= 5 || slimes.red.score >= 5) {
                gameRunning = false;
                showGameOver();
            }
        }
        
        // Функция проверки столкновения мяча со слаймом
        function checkSlimeCollision(slime, ballObj) {
            // Упрощенная проверка столкновения
            const slimeCenterX = slime.x + slime.width / 2;
            const slimeCenterY = slime.y + slime.height / 2;
            
            // Вычисляем ближайшую точку на прямоугольнике слайма к центру мяча
            const closestX = Math.max(slime.x, Math.min(ballObj.x, slime.x + slime.width));
            const closestY = Math.max(slime.y, Math.min(ballObj.y, slime.y + slime.height));
            
            // Вычисляем расстояние между ближайшей точкой и центром мяча
            const distanceX = ballObj.x - closestX;
            const distanceY = ballObj.y - closestY;
            const distanceSquared = distanceX * distanceX + distanceY * distanceY;
            
            // Если расстояние меньше радиуса мяча, происходит столкновение
            if (distanceSquared < (ballObj.radius * ballObj.radius)) {
                // Вычисляем угол отскока
                const angle = Math.atan2(ballObj.y - slimeCenterY, ballObj.x - slimeCenterX);
                
                // Устанавливаем новую скорость мяча
                const speed = Math.sqrt(ballObj.velocityX * ballObj.velocityX + ballObj.velocityY * ballObj.velocityY);
                ballObj.velocityX = Math.cos(angle) * speed * BOUNCE;
                ballObj.velocityY = Math.sin(angle) * speed * BOUNCE;
                
                // Добавляем немного скорости от движения слайма
                ballObj.velocityX += slime.velocityX * 0.5;
                
                // Сдвигаем мяч, чтобы избежать залипания
                const overlap = ballObj.radius - Math.sqrt(distanceSquared);
                ballObj.x += Math.cos(angle) * overlap;
                ballObj.y += Math.sin(angle) * overlap;
            }
        }
        
        // Функция сброса мяча
        function resetBall() {
            ball.x = canvas.width / 2;
            ball.y = canvas.height / 2;
            ball.velocityX = 0;
            ball.velocityY = 0;
        }
        
        // Функция обновления счета
        function updateScore() {
            scoreElement.textContent = `${slimes.blue.score} : ${slimes.red.score}`;
        }
        
        // Функция показа экрана окончания игры
        function showGameOver() {
            if (slimes.blue.score >= 5) {
                winnerTextElement.textContent = `${slimes.blue.name} победил!`;
            } else {
                winnerTextElement.textContent = `${slimes.red.name} победил!`;
            }
            gameOverElement.style.display = 'flex';
        }
        
        // Функция отрисовки игры
        function draw() {
            // Очистка холста
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Рисуем поле
            drawField();
            
            // Рисуем слаймов
            drawSlime(slimes.blue);
            drawSlime(slimes.red);
            
            // Рисуем мяч
            drawBall();
            
            // Рисуем золотой мяч, если он активен
            if (goldenBall.active) {
                drawGoldenBall();
            }
        }
        
        // Функция отрисовки поля
        function drawField() {
            // Трава
            ctx.fillStyle = '#2e8b57';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Центральная линия
            ctx.beginPath();
            ctx.setLineDash([10, 10]);
            ctx.moveTo(canvas.width / 2, 0);
            ctx.lineTo(canvas.width / 2, canvas.height);
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Центральный круг
            ctx.beginPath();
            ctx.arc(canvas.width / 2, canvas.height / 2, 70, 0, Math.PI * 2);
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // Вратарские площадки
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2;
            
            // Левая вратарская площадка
            ctx.strokeRect(0, (canvas.height - GOAL_HEIGHT) / 2, 50, GOAL_HEIGHT);
            
            // Правая вратарская площадка
            ctx.strokeRect(canvas.width - 50, (canvas.height - GOAL_HEIGHT) / 2, 50, GOAL_HEIGHT);
            
            // Ворота
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 4;
            
            // Левые ворота
            ctx.beginPath();
            ctx.moveTo(0, (canvas.height - GOAL_WIDTH) / 2);
            ctx.lineTo(0, (canvas.height + GOAL_WIDTH) / 2);
            ctx.stroke();
            
            // Правые ворота
            ctx.beginPath();
            ctx.moveTo(canvas.width, (canvas.height - GOAL_WIDTH) / 2);
            ctx.lineTo(canvas.width, (canvas.height + GOAL_WIDTH) / 2);
            ctx.stroke();
        }
        
        // Функция отрисовки слайма
        function drawSlime(slime) {
            ctx.fillStyle = slime.color;
            
            // Рисуем тело слайма (полукруг)
            ctx.beginPath();
            ctx.arc(slime.x + slime.width / 2, slime.y, slime.width / 2, 0, Math.PI, true);
            ctx.fill();
            
            // Рисуем прямоугольную часть слайма
            ctx.fillRect(slime.x, slime.y, slime.width, slime.height / 2);
            
            // Рисуем глаза
            ctx.fillStyle = 'white';
            const eyeRadius = slime.width / 10;
            const leftEyeX = slime.x + slime.width / 3;
            const rightEyeX = slime.x + 2 * slime.width / 3;
            const eyeY = slime.y + slime.height / 4;
            
            ctx.beginPath();
            ctx.arc(leftEyeX, eyeY, eyeRadius, 0, Math.PI * 2);
            ctx.arc(rightEyeX, eyeY, eyeRadius, 0, Math.PI * 2);
            ctx.fill();
            
            // Рисуем зрачки
            ctx.fillStyle = 'black';
            const pupilRadius = eyeRadius / 2;
            
            // Направление зрачков зависит от движения
            const pupilOffsetX = slime.velocityX !== 0 ? Math.sign(slime.velocityX) * pupilRadius / 2 : 0;
            
            ctx.beginPath();
            ctx.arc(leftEyeX + pupilOffsetX, eyeY, pupilRadius, 0, Math.PI * 2);
            ctx.arc(rightEyeX + pupilOffsetX, eyeY, pupilRadius, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // Функция отрисовки мяча
        function drawBall() {
            ctx.fillStyle = ball.color;
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fill();
            
            // Рисуем узор на мяче
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(ball.x - ball.radius, ball.y);
            ctx.lineTo(ball.x + ball.radius, ball.y);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(ball.x, ball.y - ball.radius);
            ctx.lineTo(ball.x, ball.y + ball.radius);
            ctx.stroke();
        }
        
        // Функция отрисовки золотого мяча
        function drawGoldenBall() {
            // Рисуем золотой мяч с эффектом свечения
            ctx.shadowColor = 'gold';
            ctx.shadowBlur = 15;
            
            ctx.fillStyle = goldenBall.color;
            ctx.beginPath();
            ctx.arc(goldenBall.x, goldenBall.y, goldenBall.radius, 0, Math.PI * 2);
            ctx.fill();
            
            // Рисуем узор на золотом мяче
            ctx.shadowBlur = 0;
            ctx.strokeStyle = '#ffcc00';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(goldenBall.x, goldenBall.y, goldenBall.radius, 0, Math.PI * 2);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(goldenBall.x - goldenBall.radius, goldenBall.y);
            ctx.lineTo(goldenBall.x + goldenBall.radius, goldenBall.y);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(goldenBall.x, goldenBall.y - goldenBall.radius);
            ctx.lineTo(goldenBall.x, goldenBall.y + goldenBall.radius);
            ctx.stroke();
        }
        
        // Игровой цикл
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }
        
        // Инициализация
        function init() {
            setupColorPickers();
            setupSpeedOptions();
            gameLoop();
        }
        
        // Запуск игры
        init();
    </script>
</body>
</html>
